-# Include Disqus javascripts
-#
-# Comments get added if a "post" exists
-# otherwise only the comments counter javascript is added to
-# the page.
- post = page["post"]

- if not post.nil? 
  #disqus_thread

%script{:src=>javascript, :type=>'text/javascript'}
  var disqus_shortname = '#{site.disqus_shortname}';

  - if not post.nil? 
    var disqus_identifier = '#{post.creation_date}-#{post.slug}';
    var disqus_title = '#{post.title}';
    var disqus_url = '#{post.disqus_thread_id}';

    // Comments
    (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

  // Comments Counter
  (function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
    
%noscript
  Please enable JavaScript to view the
  %a{:href=>'https://disqus.com/?ref_noscriptr', :rel=>'nofollow'}
    comments powered by Disqus.
